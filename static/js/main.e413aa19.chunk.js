(this["webpackJsonpfrontend-react"]=this["webpackJsonpfrontend-react"]||[]).push([[0],{117:function(e,t,n){e.exports=n(136)},122:function(e,t,n){},123:function(e,t,n){},125:function(e,t,n){},127:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){},134:function(e,t,n){},136:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(13),o=n.n(r),s=(n(122),n(123),n(107)),u=n(16),c=n(17),l=n(97),d=n(170),p={minVolume:.2,duration:35,layIn:2,layOut:3,before:6,after:4,precision:10};function h(e){return"".concat("//proxy.music.xinshangshangxin.com","?id=").concat(e.id,"&provider=").concat(e.provider)}var g,f=n(21),b=n(24),m=n(187),v=n(50),O=n(182),j=n(167),y=n(108),k=n(43),x=n(38),$=n(36),E=n(71),S=n(184),I=n(81),T=n(186),C=n(185),w=n(171),A=n(168),N=n(96),L=n(34),V=n(166),P=n(169);!function(e){e.ended="ended",e.error="error",e.play="play",e.playing="playing",e.pause="pause",e.timeupdate="timeupdate",e.canplay="canplay",e.stalled="stalled",e.layoutTouch="layoutTouch",e.layoutEnded="layoutEnded",e.played="played"}(g||(g={}));var q,R=function(e){Object(x.a)(n,e);var t=Object($.a)(n);function n(e){var a;return Object(f.a)(this,n),(a=t.call(this,e)).audioContext=new AudioContext,a.song=null,a.source=void 0,a.analyser=void 0,a.gainNode=void 0,a.gainVolume=1,a.errorDelaySeconds=.5,a.audio.crossOrigin="anonymous",a.audio.preload="auto",a.source=a.audioContext.createMediaElementSource(a.audio),a.analyser=a.audioContext.createAnalyser(),a.gainNode=a.audioContext.createGain(),a.source.connect(a.analyser),a.analyser.connect(a.gainNode),a.gainNode.connect(a.audioContext.destination),a}return Object(b.a)(n,[{key:"set",value:function(e){var t=e.song,n=e.currentTime,a=e.peakConfig;this.song=t,this.audio.src="".concat(this.song.url,"#t=").concat(n,",").concat(n+a.duration+a.after+1),this.audio.load(),this.changePeak({peakStartTime:t.peakStartTime,peakConfig:a})}},{key:"play",value:function(){try{this.audio.play()}catch(e){console.warn(e)}}},{key:"pause",value:function(){try{this.audio.pause()}catch(e){console.warn(e)}}},{key:"layIn",value:function(e){var t=this,n=this.song,a=this.event(g.playing).pipe(Object(m.a)((function(){console.info("======>, layIn checking \u2523 ".concat(n.name," \u252b"),t.audio.src,n)})),Object(T.a)(1),Object(d.a)((function(){return t.event(g.timeupdate).pipe(Object(T.a)(1),Object(C.a)(1e3*t.errorDelaySeconds),Object(j.a)(t.release$))})),Object(m.a)((function(){console.info("======>, layIn success \u2523 ".concat(n.name," \u252b"))})),Object(w.a)((function(){return console.warn("======>, layIn failed \u2523 ".concat(n.name," \u252b"),t.errorDelaySeconds),t.pause(),t.errorDelaySeconds=Math.pow(t.errorDelaySeconds+1,2),t.layInFailed$.next(),E.a})));return Object(S.a)(a,this.tryLayIn(e)).pipe(Object(A.a)(void 0),Object(j.a)(this.release$))}},{key:"tryLayIn",value:function(e){return this.pause(),e&&(this.audio.currentTime=e),this.peakConfig.layIn<=0||(this.gainNode.gain.setValueAtTime(0,this.audioContext.currentTime),this.gainNode.gain.linearRampToValueAtTime(this.gainVolume,this.audioContext.currentTime+this.peakConfig.layIn)),Object(I.a)(this.audio.play())}},{key:"layOut",value:function(){this.peakConfig.layOut<=0||this.gainVolume>this.peakConfig.minVolume&&(this.gainNode.gain.setValueAtTime(this.gainVolume,this.audioContext.currentTime),this.gainNode.gain.linearRampToValueAtTime(this.peakConfig.minVolume,this.audioContext.currentTime+this.peakConfig.layOut))}},{key:"release",value:function(){this.pause(),this.audio.removeAttribute("src"),this.release$.next()}},{key:"destroy",value:function(){this.source.disconnect(),this.analyser.disconnect(),this.gainNode.disconnect(),this.audioContext.close(),delete this.source,delete this.analyser,delete this.gainNode,delete this.audioContext,Object(y.a)(Object(k.a)(n.prototype),"destroy",this).call(this)}},{key:"volume",get:function(){return this.gainVolume},set:function(e){this.gainVolume=e,this.gainNode.gain.setValueAtTime(e,this.audioContext.currentTime)}}]),n}(function(){function e(t){Object(f.a)(this,e),this.audio=new Audio,this.peakConfig=void 0,this.release$=new L.a,this.layInFailed$=new L.a,this.peakStartTime=0,this.audio.crossOrigin="anonymous",this.audio.preload="auto",this.peakConfig=t}return Object(b.a)(e,[{key:"event",value:function(e){switch(e){case g.play:return this.play$();case g.played:return this.played$();case g.error:return this.error$();case g.ended:return this.ended$();case g.layoutTouch:return this.layoutTouch$();case g.layoutEnded:return this.layoutEnded$();default:return Object(V.a)(this.audio,e).pipe(Object(v.a)((function(t){return{event:e,data:t}})),Object(j.a)(Object(S.a)(Object(V.a)(this.audio,"ended"),Object(V.a)(this.audio,"error"),this.release$)))}}},{key:"changePeak",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.peakStartTime,n=e.peakConfig;void 0!==t&&(this.peakStartTime=t),void 0!==n&&Object(N.merge)(this.peakConfig,n)}},{key:"destroy",value:function(){this.release$.next(Date.now()),delete this.audio}},{key:"play$",value:function(){return Object(V.a)(this.audio,g.play).pipe(Object(T.a)(1),Object(m.a)((function(e){console.debug("====> Event:play",e)})),Object(A.a)({event:g.play}),Object(j.a)(this.release$))}},{key:"error$",value:function(){return Object(S.a)(Object(V.a)(this.audio,g.error),this.layInFailed$).pipe(Object(T.a)(1),Object(m.a)((function(e){console.debug("====> Event:error",e)})),Object(A.a)({event:g.error}),Object(j.a)(this.release$))}},{key:"ended$",value:function(){return Object(V.a)(this.audio,g.ended).pipe(Object(T.a)(1),Object(A.a)({event:g.ended}),Object(j.a)(this.release$))}},{key:"layoutTouch$",value:function(){var e=this,t=this.peakStartTime+this.peakConfig.duration+this.peakConfig.after;return Object(V.a)(this.audio,g.timeupdate).pipe(Object(P.a)((function(){return t&&e.audio.currentTime>=t-e.peakConfig.layOut?(console.debug("layoutTouch \u7247\u6bb5\u7ed3\u5c3e"),!0):e.audio.currentTime>=e.audio.duration-e.peakConfig.layOut&&(console.debug("layoutTouch \u6574\u9996\u6b4c\u7ed3\u5c3e"),!0)})),Object(T.a)(1),Object(v.a)((function(){return{event:g.layoutTouch,data:{endTime:t,currentTime:e.audio.currentTime}}})),Object(j.a)(Object(S.a)(Object(V.a)(this.audio,"ended"),Object(V.a)(this.audio,"error"),this.release$)))}},{key:"layoutEnded$",value:function(){var e=this,t=this.peakStartTime+this.peakConfig.duration+this.peakConfig.after;return Object(V.a)(this.audio,g.timeupdate).pipe(Object(P.a)((function(){return!!(t&&e.audio.currentTime>=t)||e.audio.currentTime>=e.audio.duration})),Object(T.a)(1),Object(A.a)({event:g.layoutEnded}),Object(j.a)(Object(S.a)(Object(V.a)(this.audio,g.ended),Object(V.a)(this.audio,g.error),this.release$)))}},{key:"played$",value:function(){return Object(V.a)(this.audio,g.playing).pipe(Object(T.a)(1),Object(A.a)({event:g.played}),Object(j.a)(this.release$))}}]),e}()),D=function(){function e(){Object(f.a)(this,e),this.pool={},this.restList=[]}return Object(b.a)(e,[{key:"maintain",value:function(e){var t=this,n=e.list,a=e.peakConfig;Object.keys(this.pool).filter((function(e){return!n.some((function(t){return t.song.url===e}))})).forEach((function(e){t.release(e)})),n.forEach((function(e){var n=e.song,i=e.preload$;t.getSong({song:n,peakConfig:a},i)}))}},{key:"getSong",value:function(e,t){var n=e.song,a=e.peakConfig;return this.checkInPool(n,a)||this.createPoolItem(e,t),this.getPoolItem(n)}},{key:"getPoolItem",value:function(e){return this.pool[e.url]}},{key:"checkInPool",value:function(e,t){var n=this.getPoolItem(e);return!!n&&(!(!n.rxAudio||n.rxAudio.audio.paused)||(n.peakConfig.duration===t.duration||(console.info("peakConfig change, rebuild"),this.release(e.url),!1)))}},{key:"release",value:function(e){var t=this.pool[e];if(t){var n=t.subscription,a=t.rxAudio;a.release(),n.unsubscribe(),delete this.pool[e],this.restList.push(a)}}},{key:"createPoolItem",value:function(e,t){var n,a=e.song,i=e.peakConfig;n=this.restList.length?this.restList.pop():new R(i);var r=t.pipe(Object(m.a)((function(e){var t=e.song;n.set({song:t,currentTime:t.peakStartTime,peakConfig:i})})),Object(v.a)((function(e){return Object(c.a)(Object(c.a)({},e),{},{rxAudio:n})})),Object(O.a)({bufferSize:1,refCount:!0}),Object(j.a)(n.release$));this.pool[a.url]={subscription:r.subscribe((function(e){var t=e.song;console.debug("\u9884\u8f7d\u5165 \u2523 ".concat(t.name," \u252b \u6210\u529f"),t)}),console.warn),source$:r,peakConfig:Object(c.a)({},i),rxAudio:n}}}]),e}(),M=n(73),_=n(188),F=n(172),U=n(183),X=n(85);!function(e){e.playing="playing",e.paused="paused",e.loading="loading"}(q||(q={}));var G={preloadLen:2,peakConfig:Object(c.a)({},p),errorRetry:{songRetries:3,playerRetries:10},volume:1,currentIndex:0,basePlaylistId:"\u4e34\u65f6\u5217\u8868"},z=function(e){Object(x.a)(n,e);var t=Object($.a)(n);function n(){var e;return Object(f.a)(this,n),(e=t.call(this)).songChange$=void 0,e.songChange$=Object(S.a)(e.click$.pipe(Object(_.a)(500),Object(m.a)((function(t){e.setIndex(t),e.status=q.loading})),Object(A.a)("click")),e.end$.pipe(Object(_.a)(500),Object(m.a)((function(){e.setIndexStep(1)})),Object(A.a)("end")),e.error$.pipe(Object(m.a)((function(){e.errorStatus.nu+=1,e.errorStatus.continuous+=1,e.errorStatus.continuous>=e.config.errorRetry.playerRetries&&(e.status=q.paused),e.errorStatus.nu>=e.config.errorRetry.songRetries&&e.setIndexStep(1),console.debug(Object(c.a)(Object(c.a)({},e.errorStatus),e.config.errorRetry))})),Object(A.a)("error"))).pipe(Object(d.a)((function(t){return console.debug("\u6b4c\u66f2\u53d8\u66f4\u89e6\u53d1","\u89e6\u53d1\u7c7b\u578b",t,"\u89e6\u53d1\u6b4c\u66f2\u4e0b\u6807",e.currentIndex,e.currentSong),"click"===t?Object(l.a)(null):"end"===t?Object(l.a)(null).pipe(Object(F.a)(10)):"error"===t?Object(l.a)(null).pipe(Object(F.a)(500*Math.sqrt(e.errorStatus.nu))):Object(l.a)(null)})),Object(m.a)((function(){e.rxAudio&&e.rxAudio.pause(),e.status!==q.paused&&(e.status=q.loading)})),Object(v.a)((function(){return e.getSong(e.currentIndex)})),Object(P.a)((function(e){return!!e})),Object(w.a)((function(t,n){return console.warn("songChange$ error",t),e.status=q.paused,n})),Object(U.a)()),e}return Object(b.a)(n,[{key:"play",value:function(){this.status=q.loading,this.rxAudio?(this.rxAudio.layIn(),this.play$.next()):this.playAt(this.currentIndex)}},{key:"playSong",value:function(e){var t=this;return e.pipe(Object(m.a)((function(e){var n=e.song,a=e.rxAudio,i=e.changed;console.debug("play \u2523 ".concat(n.name," \u252b \u2523 ").concat(n.provider," \u252b"),{currentTime:a.audio.currentTime,src:a.audio.src,currentIndex:t.currentIndex,status:t.status,peakConfig:a.peakConfig,song:n}),i&&(console.debug("song changed, update song info",n),t.updateSongInfo(n),t.persistTask$.next()),t.songStatus$({song:n,rxAudio:a}).pipe(Object(j.a)(t.songChange$)).subscribe((function(){}),(function(e){console.warn("songStatus$ handle error",e)}))})),Object(d.a)((function(e){var n=e.song,a=e.rxAudio;return a?(t.rxAudio=a,t.status===q.paused?(console.debug("\u5f53\u524d\u72b6\u6001\u4e3a\u505c\u6b62\u72b6\u6001",n),Object(l.a)({rxAudio:a,song:n})):(t.status=q.playing,t.setAudioVolume(t.volume),a.layIn(n.peakStartTime).pipe(Object(m.a)((function(){t.play$.next()})),Object(v.a)((function(){return{song:n,rxAudio:a}}))))):Object(M.a)("no rxAudio")})),Object(w.a)((function(e){return console.warn("load audio error",e),t.status!==q.paused&&t.error$.next({index:t.currentIndex,data:e}),E.a})),Object(j.a)(this.songChange$))}},{key:"songStatus$",value:function(e){var t=this,n=e.song,a=e.rxAudio;return Object(S.a)(a.event(g.error).pipe(Object(m.a)((function(){t.error$.next({index:t.currentIndex,data:g.error})}))),Object(S.a)(a.event(g.ended),a.event(g.layoutEnded)).pipe(Object(_.a)(500),Object(m.a)((function(){t.end$.next(n)}))),a.event(g.layoutTouch).pipe(Object(m.a)((function(){a.layOut()}))),a.event(g.played).pipe(Object(m.a)((function(){t.played$.next(),t.errorStatus.continuous=0,t.loadNextSongs()}))))}},{key:"updateSongInfo",value:function(e){var t=this.songList.findIndex((function(t){var n=t.id,a=t.provider;return n===e.id&&a===e.provider}));t>=0&&this.songList.splice(t,1,e)}}]),n}(function(e){Object(x.a)(n,e);var t=Object($.a)(n);function n(){return Object(f.a)(this,n),t.apply(this,arguments)}return Object(b.a)(n,[{key:"setVolume",value:function(e){this.volume=e,this.setAudioVolume(e)}},{key:"pause",value:function(){this.status=q.paused,this.rxAudio&&this.rxAudio.pause()}},{key:"previous",value:function(){this.songList.length&&this.click$.next(this.getValidIndex(this.currentIndex-1))}},{key:"next",value:function(){this.songList.length&&this.end$.next()}},{key:"playAt",value:function(e){if("object"===typeof e){var t=this.song2index(e);this.click$.next(this.position2index(t,!0))}else this.click$.next(this.position2index(e,!0))}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"current",n=this.currentSong,a=this.songList.findIndex((function(t){var n=t.provider,a=t.id;return n===e.provider&&a===e.id}));a>=0&&this.songList.splice(a,1);var i=this.position2index(t);this.songList.splice(i,0,Object(c.a)(Object(c.a)({},e),{},{url:h(e)})),this.currentIndex=this.song2index(n),this.persistTask$.next()}},{key:"remove",value:function(e){var t,n=this.currentSong;t="number"!==typeof e?this.song2index(e):e,this.songList.splice(this.getValidIndex(t),1),this.currentIndex===t?(this.error$.next({index:this.currentIndex,data:"delete playing song"}),this.status===q.paused&&this.pause()):this.currentIndex=this.song2index(n),this.persistTask$.next()}},{key:"updateSongs",value:function(e){var t,n=e.map((function(e){return Object(c.a)(Object(c.a)({},e),{},{url:h(e)})}));this.songList.length=0,(t=this.songList).push.apply(t,Object(X.a)(n))}},{key:"loadSongList",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.currentIndex=t,this.updateSongs(e),this.persistTask$.next(),this.songList.length&&a&&this.loadNextSongs(),n&&this.songList.length&&this.playAt(this.currentIndex)}},{key:"loadNextSongs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.getValidIndex(this.currentIndex+e),n=t+this.config.preloadLen+1,a=[];n<=this.songList.length?a=this.songList.slice(t,n):(n=this.getValidIndex(n),a=[].concat(Object(X.a)(this.songList.slice(t)),Object(X.a)(this.songList.slice(0,n)))),console.info("load songs: ",[t,n],a.map((function(e){return e.name}))),this.preloadTask$.next(a)}},{key:"position2index",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(e){case"current":-1===(t=this.getValidIndex(this.currentIndex))&&(t=0);break;case"next":t=this.getValidIndex(this.currentIndex+1);break;case"end":t=this.songList.length,n&&(t=this.getValidIndex(t-1));break;default:t=e}return t}},{key:"song2index",value:function(e){return null===e?-1:this.songList.findIndex((function(t){return t.id===e.id&&t.provider===e.provider}))}},{key:"getValidIndex",value:function(e){return this.songList.length?(e+=this.songList.length)<0?-1:e%this.songList.length:-1}},{key:"setIndex",value:function(e){return this.currentIndex=this.getValidIndex(e),this.errorStatus.nu=0,this.currentIndex}},{key:"setIndexStep",value:function(e){return this.setIndex(this.currentIndex+e)}},{key:"setAudioVolume",value:function(e){this.rxAudio&&(this.rxAudio.volume=e)}},{key:"getSong",value:function(e){return(e=this.getValidIndex(e))<0?null:this.songList[e]}},{key:"currentSong",get:function(){return this.getSong(this.currentIndex)}}]),n}(function(e){Object(x.a)(n,e);var t=Object($.a)(n);function n(){var e;Object(f.a)(this,n);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(e=t.call.apply(t,[this].concat(i))).status=q.paused,e}return Object(b.a)(n,[{key:"isPaused",get:function(){return this.status===q.paused}}]),n}((function e(){Object(f.a)(this,e),this.currentIndex=-1,this.songList=[],this.click$=new L.a,this.end$=new L.a,this.error$=new L.a,this.persistTask$=new L.a,this.preloadTask$=new L.a,this.play$=new L.a,this.played$=new L.a,this.config=Object(c.a)({},G),this.rxAudio=void 0,this.volume=1,this.basePlaylistId="\u4e34\u65f6\u5217\u8868",this.errorStatus={nu:0,continuous:0}})))),H=new D,K=new z;K.songChange$.pipe(Object(d.a)((function(e){var t=H.getSong({song:e,peakConfig:Object(c.a)(Object(c.a)({},p),{},{duration:Number.MAX_SAFE_INTEGER})},Object(l.a)({song:Object(c.a)(Object(c.a)({},e),{},{url:h(e),peakStartTime:0,peakDuration:Number.MAX_SAFE_INTEGER}),changed:!1}));return K.playSong(t.source$)}))).subscribe(console.log,console.warn);var B,J,W,Q=n(47),Y=n(138),Z=n(48),ee=n.n(Z);function te(){var e=Object(Q.a)(["\n    query song($id: String!, $provider: Provider!, $duration: Int) {\n  song(id: $id, provider: $provider) {\n    provider\n    id\n    name\n    duration\n    artists {\n      id\n      name\n    }\n    startTime(duration: $duration)\n    privilege\n  }\n}\n    "]);return te=function(){return e},e}function ne(){var e=Object(Q.a)(["\n    query search($keyword: String!, $providers: [Provider!]) {\n  search(keyword: $keyword, providers: $providers) {\n    id\n    name\n    provider\n    artists {\n      name\n    }\n    album {\n      name\n    }\n  }\n}\n    "]);return ne=function(){return e},e}function ae(){var e=Object(Q.a)(["\n    query parseUrl($url: String!) {\n  parseUrl(url: $url) {\n    id\n    provider\n    name\n    artists {\n      name\n    }\n  }\n}\n    "]);return ae=function(){return e},e}function ie(){var e=Object(Q.a)(["\n    query lrc($id: String!, $provider: Provider!) {\n  lrc(id: $id, provider: $provider) {\n    items {\n      duration\n      offset\n      line\n    }\n  }\n}\n    "]);return ie=function(){return e},e}function re(){var e=Object(Q.a)(["\n    query krc($id: String!, $provider: Provider!) {\n  krc(id: $id, provider: $provider) {\n    items\n  }\n}\n    "]);return re=function(){return e},e}function oe(){var e=Object(Q.a)(["\n    mutation addPeakTime($id: String!, $provider: Provider!, $peak: SongPeaksInput!) {\n  addPeakTime(id: $id, provider: $provider, peak: $peak)\n}\n    "]);return oe=function(){return e},e}!function(e){e.Kugou="kugou",e.Netease="netease",e.Xiami="xiami"}(B||(B={})),function(e){e.Deny="deny",e.Allow="allow",e.Unknown="unknown"}(J||(J={})),function(e){e.Mid="mid",e.High="high",e.Sq="sq",e.Hq="hq"}(W||(W={}));var se=ee()(oe()),ue=ee()(re()),ce=ee()(ie()),le=ee()(ae()),de=ee()(ne()),pe=ee()(te()),he=function(e){return e()};var ge=[{id:"6e490acfb95e6fc8870b5c7d0ea40c23",name:"\u4f60\u5c31\u4e0d\u8981\u60f3\u8d77\u6211",provider:B.Kugou,artists:[{id:"6046",name:"\u7530\u99a5\u7504"}],album:{id:"965595",name:"\u6e3a\u5c0f",img:"http://imge.kugou.com/stdmusic/400/20160713/20160713100013479508.jpg"},duration:282,privilege:"allow",peakDuration:35,peakStartTime:185},{id:"1770409076",name:"\u9b54\u9b3c\u4e2d\u7684\u5929\u4f7f",provider:B.Xiami,artists:[{id:"78523",name:"\u7530\u99a5\u7504"}],album:{id:"459960",name:"My Love",img:"http://img.xiami.net/images/album/img72/801972/4599601526801972_3.jpg"},peakStartTime:166.6,duration:null,privilege:"allow",peakDuration:35},{id:"296885",name:"\u5bc2\u5bde\u5bc2\u5bde\u5c31\u597d",provider:B.Netease,artists:[{id:"9548",name:"\u7530\u99a5\u7504"}],album:{id:"29447",name:"To Hebe",img:"https://p1.music.126.net/_o12jScXd17VO79VCsitbA==/109951163167534993.jpg"},peakStartTime:87.9,duration:275.12,privilege:"allow",peakDuration:35}],fe=n(25),be=(n(125),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:he;return{addPeakTime:function(n){return t((function(){return e.request(Object(Y.print)(se),n)}))},krc:function(n){return t((function(){return e.request(Object(Y.print)(ue),n)}))},lrc:function(n){return t((function(){return e.request(Object(Y.print)(ce),n)}))},parseUrl:function(n){return t((function(){return e.request(Object(Y.print)(le),n)}))},search:function(n){return t((function(){return e.request(Object(Y.print)(de),n)}))},song:function(n){return t((function(){return e.request(Object(Y.print)(pe),n)}))}}}(new(n(98).GraphQLClient)("https://music.xinshangshangxin.com/graphql"))),me=(n(127),n(175)),ve=n(104),Oe=n.n(ve),je=n(103),ye=n.n(je),ke=n(105),xe=n.n(ke),$e=n(102),Ee=n.n($e),Se=n(174),Ie=(n(173),function(e){var t=Object(a.useMemo)((function(){return new L.a}),[]),n=Object(a.useCallback)((function(e){return t.next(e)}),[t]);return Object(a.useEffect)((function(){return e instanceof Array&&e(t),function(){return t.complete()}}),[e,t]),[n,t]});function Te(){var e,t,n=Object(a.useState)(K.currentSong),r=Object(fe.a)(n,2),o=r[0],s=r[1];Object(a.useEffect)((function(){var e=K.songChange$.subscribe((function(){s(K.currentSong)}));return function(){e.unsubscribe()}}));var u=Object(a.useState)(K.isPaused),c=Object(fe.a)(u,2),l=c[0],d=c[1];Object(a.useEffect)((function(){}));var p=Ie(),h=Object(fe.a)(p,2),g=h[0],f=h[1];Object(a.useEffect)((function(){var e=f.pipe(Object(Se.a)(100)).subscribe((function(){console.info("player.isPaused: ",K.isPaused),K.isPaused?(K.play(),d(!1)):(K.pause(),d(!0))}));return function(){e.unsubscribe()}}));var b=Ie(),m=Object(fe.a)(b,2),v=m[0],O=m[1];Object(a.useEffect)((function(){var e=O.subscribe((function(){K.next()}));return function(){e.unsubscribe()}}));var j=Ie(),y=Object(fe.a)(j,2),k=y[0],x=y[1];return Object(a.useEffect)((function(){var e=x.subscribe((function(){K.next()}));return function(){e.unsubscribe()}})),i.a.createElement("div",{className:"play-bar"},i.a.createElement("div",{className:"bottom"},i.a.createElement("div",{className:"left"},i.a.createElement("div",{className:"cover"},i.a.createElement("img",{src:(null===o||void 0===o||null===(e=o.album)||void 0===e?void 0:e.img)||void 0,alt:"img"})),i.a.createElement("div",{className:"info"},i.a.createElement("div",{className:"song-name"},null===o||void 0===o?void 0:o.name),i.a.createElement("div",{className:"singers"},null===o||void 0===o||null===(t=o.artists)||void 0===t?void 0:t.map((function(e){return e.name})).join(", ")))),i.a.createElement("div",{className:"center"},i.a.createElement("div",{className:"controls"},i.a.createElement(me.a,{className:"previous",onClick:v},i.a.createElement(Ee.a,null)),i.a.createElement("div",{className:"play-btn",onClick:g},l?i.a.createElement(me.a,null,i.a.createElement(ye.a,null)):i.a.createElement(me.a,null,i.a.createElement(Oe.a,null))),i.a.createElement(me.a,{className:"next",onClick:k},i.a.createElement(xe.a,null)))),i.a.createElement("div",{className:"right"})))}n(132),n(133);var Ce=function(e){var t,n=Ie(),r=Object(fe.a)(n,2),o=r[0],s=r[1];return Object(a.useEffect)((function(){var t=s.subscribe((function(){var t=K.song2index(e.song);console.info("====",t,K.songList),-1===t?(K.add(e.song,"end"),K.playAt("end")):K.playAt(t)}),console.warn);return function(){t.unsubscribe()}})),i.a.createElement("div",{className:"song-box"},i.a.createElement("span",{className:"song-info",onClick:o},i.a.createElement("img",{className:"logo",src:"assets/logos/kugou.png",alt:"logo"}),i.a.createElement("span",{className:"song-name"},e.song.name),i.a.createElement("span",{className:"song-artists"},null===(t=e.song.artists)||void 0===t?void 0:t.map((function(e){return e.name})).join(", ")),i.a.createElement("span",{className:"song-control"},i.a.createElement("i",{className:"material-icons"}))))};var we=function(e){return i.a.createElement("div",{className:"song-list"},e.songs.map((function(e){return i.a.createElement(Ce,{key:e.id+e.provider,song:e})})))},Ae=(n(134),n(180)),Ne=n(181),Le=n(106),Ve=n.n(Le),Pe=n(179),qe=new L.a;function Re(){var e=Ie(),t=Object(fe.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){var e=r.pipe(Object(v.a)((function(e){return e.target.value})),Object(v.a)((function(e){return(e||"").trim()})),Object(Se.a)(300),Object(Pe.a)()).subscribe((function(e){console.info("data: ",e),qe.next(e)}),console.warn);return function(){e.unsubscribe()}})),i.a.createElement("div",{className:"top-nav"},i.a.createElement(Ae.a,null,"Music"),i.a.createElement("div",{className:"search"},i.a.createElement(Ne.a,{type:"text",placeholder:"\u6b4c\u66f2/\u6b4c\u624b",onKeyUp:n})),i.a.createElement(me.a,{"aria-label":"delete",size:"small"},i.a.createElement(Ve.a,{fontSize:"inherit"})))}function De(){var e=Object(a.useState)(K.songList),t=Object(fe.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){var e=qe.pipe(Object(d.a)((function(e){return e?Object(I.a)(be.search({keyword:e})):Object(l.a)({search:K.songList})}))).subscribe((function(e){console.info(e),r(e.search)}));return function(){e.unsubscribe()}})),i.a.createElement("div",{className:"layout"},i.a.createElement(Re,null),i.a.createElement("div",{className:"main"},i.a.createElement(we,{songs:n})),i.a.createElement("div",{className:"play-bar"},i.a.createElement(Te,null)))}function Me(){return K.loadSongList(ge),i.a.createElement(s.a,null,i.a.createElement(u.c,null,i.a.createElement(u.a,{path:"/about"}),i.a.createElement(u.a,{path:"/topics"}),i.a.createElement(u.a,{path:"/"},i.a.createElement(De,null))))}qe.next();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(Me,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[117,1,2]]]);
//# sourceMappingURL=main.e413aa19.chunk.js.map